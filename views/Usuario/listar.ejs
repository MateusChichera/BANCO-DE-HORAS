<script src="/js/Usuario/listar.js"></script>
<script src="/js/Usuario/relatorio.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.5/xlsx.full.min.js"></script>
<style>
    body {
        background-color: #36393f;
        color: white;
        font-family: Arial, sans-serif;
    }

    table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 20px;
    }

    table, th, td {
        border: 1px solid #2c2f33;
    }

    th, td {
        padding: 10px;
        text-align: center;
    }

    th {
        background-color: #202225;
        color: white;
        font-weight: bold;
    }

    tr:nth-child(even) {
        background-color: #2c2f33;
    }

    tr:hover {
        background-color: #4f5459;
    }

    td {
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .extra-column {
        font-weight: bold;
        color: #43b581; /* cor verde (pode ajustar conforme necessário) */
    }

    /* Adicione a regra abaixo para garantir que o texto seja branco */
    body {
        color: white;
    }
  </style>
  <script>
document.addEventListener('DOMContentLoaded', function () {
    // Obtendo o ID do usuário dos cookies
    const userId = getCookie('userId');

    // Selecionando o elemento do select
    const selectUsuario = document.getElementById('usuario');

    // Verificando se o ID do usuário foi encontrado nos cookies
    if (userId) {
        // Definindo o valor do select com base no ID do usuário
        selectUsuario.value = userId;

        // Se o userId for 4, permite alterar o select, caso contrário, desabilita
        if (userId != '4') {
            // Desabilitando o select para impedir alterações
            selectUsuario.disabled = true;
        }
    }
});

// Função para obter o valor de um cookie pelo nome
function getCookie(name) {
    const cookies = document.cookie.split(';');
    for (let i = 0; i < cookies.length; i++) {
        const cookie = cookies[i].trim();
        // Verifica se o cookie começa com o nome desejado
        if (cookie.startsWith(name + '=')) {
            // Retorna o valor do cookie sem o nome
            return cookie.substring(name.length + 1);
        }
    }
    return ''; // Retorna uma string vazia se o cookie não for encontrado
}

    </script>
<div>
    <h1>Horas e Implantações</h1>
    <div class="form-row">
        <div class="form-group col-md-4">
            <label for="usuario">Usuario:</label>
            <select class="form-control" id="usuario">
                <option value="0">--Selecione--</option>
                <option value="1">Mateus</option>
                <option value="2">Carlos Muller</option>
                <option value="3">Vinicius</option>
            </select>
        </div>
        <div class="form-group col-md-4">
            <label for="dia">Data Inicio:</label>
            <input class="form-control" type="date" id="dia" />
        </div>
        <div class="form-group col-md-4">
            <label for="dia2">Data Fim:</label>
            <input class="form-control" type="date" id="dia2" />
        </div>
    </div>
    <div class="d-flex justify-content-end mb-3">
        <a id="pesquisarBtn" class="btn btn-primary">Pesquisar</a>
    </div>
    <div class="table-responsive">
        <table class="table table-stripped">
            <thead>
                <th>Data</th>
                <th>Entrada</th>
                <th>Cafe</th>
                <th>Cafe</th>
                <th>Almoco</th>
                <th>Almoco</th>
                <th>Cafe</th>
                <th>Cafe</th>
                <th>Saida</th>
                <th>Extra</th>
            </thead>
            <tbody></tbody> <!-- Adicionado o elemento tbody -->
        </table>
        <table id="tabelaImplantacoes">
            <thead>
                <tr>
                    <th>Nome</th>
                    <th>Cidade</th>
                    <th>Estado</th>
                    <th>Dia</th>
                    <th>Tipo</th>
                    <th>Observações</th>
                    <th>Ações</th>
                </tr>
            </thead>
            <tbody>
                <!-- As linhas da tabela de implantações serão adicionadas dinamicamente aqui -->
            </tbody>
        </table>
        <div class="d-flex justify-content-end mb-3">
            <button id="exportarExcelBtn" class="btn btn-success">Exportar Horas para Excel</button>
        </div>
        <!-- Relatório de Distâncias -->
        <hr>
        <h2>Relatório de Distâncias (KM)</h2>
        <div id="relatorioViagensContainer" style="margin-bottom: 20px;">
            <p><strong>Cidades Visitadas:</strong></p>
            <ul id="listaCidadesVisitadas" style="list-style: inside; padding-left: 10px;"></ul>

            <p><strong>Total de KM percorridos:</strong> <span id="totalKm">--</span> km</p>
        </div>

        <!-- Botão Exportar Implantações -->
        <div class="d-flex justify-content-end mb-3">
            <button id="exportarExcelBtn1" class="btn btn-success">Exportar Implantações para Excel</button>
        </div>

        <div class="d-flex justify-content-end mb-3">
            <button id="exportarExcelBtn1" class="btn btn-success">Exportar Implantações para Excel</button>
        </div>
    </div>
    
</div>
